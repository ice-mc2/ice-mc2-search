{"version":3,"sources":["../../../src/chat/messages/MessageText.js"],"names":["Remarkable","require","MessageText","text","md","split","replace","length","raw_attachments","rendered_text","render","attachments","JSON","parse","atob","is_image","match","is_equation","re","module","exports"],"mappings":";;;;;;AAAA,IAAIA,aAAaC,QAAQ,YAAR,CAAjB;;IAEMC,W;AACF,yBAAYC,IAAZ,EAAiB;AAAA;;AACb,aAAKC,EAAL,GAAU,IAAIJ,UAAJ,EAAV;AACAG,eAAOA,KAAKE,KAAL,CAAW,gCAAX,CAAP;AACA,aAAKF,IAAL,GAAYA,KAAK,CAAL,EAAQG,OAAR,CAAgB,UAAhB,EAA4B,EAA5B,CAAZ;AACA,YAAGH,KAAKI,MAAL,GAAc,CAAjB,EAAmB;AACfJ,mBAAOA,KAAK,CAAL,EAAQE,KAAR,CAAc,8BAAd,CAAP;AACA,iBAAKG,eAAL,GAAuBL,KAAK,CAAL,EAAQG,OAAR,CAAgB,UAAhB,EAA4B,EAA5B,CAAvB;AACH,SAHD,MAGO;AACH,iBAAKE,eAAL,GAAuB,MAAvB;AACH;;AAED,aAAKC,aAAL,GAAqB,KAAKL,EAAL,CAAQM,MAAR,CAAe,KAAKP,IAApB,CAArB;AACA,aAAKQ,WAAL,GAAmBC,KAAKC,KAAL,CAAWC,KAAK,KAAKN,eAAV,CAAX,CAAnB;;AAEA,aAAKO,QAAL,GAAgB,KAAKZ,IAAL,CAAUa,KAAV,CAAgB,gBAAhB,CAAhB;AACA,aAAKC,WAAL,GAAmB,KAAKd,IAAL,CAAUa,KAAV,CAAgB,mBAAhB,CAAnB;AACH;;;;iCAEO;AACJ,mBAAO,KAAKb,IAAZ;AACH;;;0CAEgB;AACb,mBAAO,KAAKM,aAAZ;AACH;;;4CAEkB;AACf,mBAAO,KAAKD,eAAZ;AACH;;;yCAEe;AACZ,mBAAO,KAAKG,WAAZ;AACH;;;uCAEa;AACV,mBAAO,KAAKA,WAAL,CAAiB,YAAjB,CAAP;AACH;;;uCAEa;AACV,mBAAOG,KAAK,KAAKH,WAAL,CAAiB,YAAjB,CAAL,CAAP;AACH;;;qCAEW;AACR,mBAAO,KAAKM,WAAZ;AACH;;;kCAEQ;AACL,mBAAO,KAAKF,QAAZ;AACH;;;mCAES;AACN,gBAAIG,KAAK,gBAAT;AACA,mBAAO,KAAKf,IAAL,CAAUG,OAAV,CAAkBY,EAAlB,EAAsB,EAAtB,CAAP;AACH;;;;;;AAGLC,OAAOC,OAAP,GAAiBlB,WAAjB","file":"MessageText.js","sourcesContent":["var Remarkable = require('remarkable');\r\n\r\nclass MessageText {\r\n    constructor(text){\r\n        this.md = new Remarkable();\r\n        text = text.split(\"-----MC2 BEGIN ATTACHMENT-----\");\r\n        this.text = text[0].replace(/^\\n|\\n$/g, '');\r\n        if(text.length > 1){\r\n            text = text[1].split(\"-----MC2 END ATTACHMENT-----\");\r\n            this.raw_attachments = text[0].replace(/^\\n|\\n$/g, '');\r\n        } else {\r\n            this.raw_attachments = \"e30=\";\r\n        }\r\n\r\n        this.rendered_text = this.md.render(this.text);\r\n        this.attachments = JSON.parse(atob(this.raw_attachments));\r\n\r\n        this.is_image = this.text.match(/^\\[mc2-image\\]/);\r\n        this.is_equation = this.text.match(/^\\$\\$[\\s\\S]*\\$\\$$/);\r\n    }\r\n\r\n    getRaw(){\r\n        return this.text;\r\n    }\r\n\r\n    getRenderedText(){\r\n        return this.rendered_text;\r\n    }\r\n\r\n    getRawAttachments(){\r\n        return this.raw_attachments;\r\n    }\r\n\r\n    getAttachments(){\r\n        return this.attachments;\r\n    }\r\n\r\n    hasSvgSource(){\r\n        return this.attachments['svg-source'];\r\n    }\r\n\r\n    getSvgSource(){\r\n        return atob(this.attachments['svg-source']);\r\n    }\r\n\r\n    isEquation(){\r\n        return this.is_equation;\r\n    }\r\n\r\n    isImage(){\r\n        return this.is_image;\r\n    }\r\n\r\n    getImage(){\r\n        var re = /^\\[mc2-image\\]/;\r\n        return this.text.replace(re, \"\");\r\n    }\r\n}\r\n\r\nmodule.exports = MessageText;"]}